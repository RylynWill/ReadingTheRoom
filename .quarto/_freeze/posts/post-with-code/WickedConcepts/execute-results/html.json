{
  "hash": "cf2b2f0170d6c955bc5e609b5e643601",
  "result": {
    "markdown": "---\ntitle: \"Wicked Concepts\"\nauthor: \"Rylyn Williams\"\nformat: \n  html: \n    df-print: paged\n    embed-resources: true\n    code-fold: true\n    self-contained-math: true\n---\n\n\n\n\n\n\n\n\n\n\n## Data wrangling\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#read in data tables from survey, 35 by 9 data table\nq1 <- read_csv(\"data/q1.csv\", show_col_types = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...1`\n```\n:::\n\n```{.r .cell-code}\nq2 <- read_csv(\"data/q2.csv\", show_col_types = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...1`\n```\n:::\n\n```{.r .cell-code}\nq3 <- read_csv(\"data/q3.csv\", show_col_types = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...1`\n```\n:::\n\n```{.r .cell-code}\nq4 <- read_csv(\"data/q4.csv\", show_col_types = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...1`\n```\n:::\n\n```{.r .cell-code}\nq5 <- read_csv(\"data/q5.csv\", show_col_types = FALSE )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...1`\n```\n:::\n\n```{.r .cell-code}\n# remove total row so that it's 35 by 8, including column of concepts\nq1 <- select(q1, -9)\nq2 <- select(q2, -9)\nq3 <- select(q3, -9)\nq4 <- select(q4, -9)\nq5 <- select(q5, -9)\n\nhead(q1, 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"...1\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Imperialism\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Capitalism\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Racism\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Colonizaton\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Housing\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Education\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Infrastructure\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Imperialism\",\"2\":\"10\",\"3\":\"15\",\"4\":\"12\",\"5\":\"5\",\"6\":\"4\",\"7\":\"5\",\"8\":\"5\"},{\"1\":\"Capitalism\",\"2\":\"9\",\"3\":\"10\",\"4\":\"12\",\"5\":\"4\",\"6\":\"3\",\"7\":\"5\",\"8\":\"3\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nhead(q2, 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"...1\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Criminal Justice\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Transportation\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Economy\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Income/wealth\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Corporate wealth\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Fed/Gov't Structure\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Gun Control\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Imperialism\",\"2\":\"12\",\"3\":\"5\",\"4\":\"11\",\"5\":\"8\",\"6\":\"8\",\"7\":\"10\",\"8\":\"6\"},{\"1\":\"Capitalism\",\"2\":\"7\",\"3\":\"6\",\"4\":\"8\",\"5\":\"9\",\"6\":\"10\",\"7\":\"8\",\"8\":\"7\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nhead(q3, 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"...1\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Banking\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Voting Access\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Climate Change\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Child Poverty\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Nationalizing\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Digital lit\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"AI\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Imperialism\",\"2\":\"9\",\"3\":\"4\",\"4\":\"8\",\"5\":\"4\",\"6\":\"11\",\"7\":\"5\",\"8\":\"5\"},{\"1\":\"Capitalism\",\"2\":\"8\",\"3\":\"7\",\"4\":\"5\",\"5\":\"6\",\"6\":\"9\",\"7\":\"5\",\"8\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nhead(q4, 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"...1\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Immigration\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Misinformation\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pollution & Plastic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Indigenous Sovereignty\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Weakening of Global West\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Public Trust\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Homeless Rights\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Imperialism\",\"2\":\"10\",\"3\":\"10\",\"4\":\"6\",\"5\":\"7\",\"6\":\"8\",\"7\":\"6\",\"8\":\"3\"},{\"1\":\"Capitalism\",\"2\":\"7\",\"3\":\"7\",\"4\":\"8\",\"5\":\"5\",\"6\":\"8\",\"7\":\"5\",\"8\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nhead(q5, 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"...1\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Welfare Systems\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Civil Rights\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Journalism/media\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Foreign Policy\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Insider Trading\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Generational Wealth\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Eurocentrism\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Imperialism\",\"2\":\"8\",\"3\":\"10\",\"4\":\"6\",\"5\":\"10\",\"6\":\"4\",\"7\":\"4\",\"8\":\"8\"},{\"1\":\"Capitalism\",\"2\":\"5\",\"3\":\"6\",\"4\":\"4\",\"5\":\"8\",\"6\":\"7\",\"7\":\"6\",\"8\":\"7\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Join columns by term column, to create 35 by 35\nconcepts <- left_join(q1,q2,by=\"...1\")\nconcepts <- left_join(concepts,q3,by=\"...1\")\nconcepts <- left_join(concepts,q4,by=\"...1\")\nconcepts <- left_join(concepts,q5,by=\"...1\")\nconcepts <- select(concepts, -1)\nrownames(concepts)<-colnames(concepts)\nnamesss <- colnames(concepts)\n```\n:::\n\n`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconcepts <- as.matrix(concepts)\n#replace NA's with Zero as the value is not missing, there is just no tie so there weight it 0\nconcepts[is.na(concepts)] <- 0\n# Set diag to false to remove self loops\ncg <- graph_from_adjacency_matrix(concepts)\n#Save the graph as a data frame that shows each ties and their weight.\ncg_frame <-get.data.frame(cg)\n```\n:::\n\n### Create a tnet object out of single counted actor ties, with weights being the count of the tie appearence\n\n::: {.cell}\n\n```{.r .cell-code}\n#Identify unique vertices for the purpose of \nunique_vertices <- unique(c(cg_frame$from, cg_frame$to))\nvalid_vertices <- unique_vertices[!duplicated(unique_vertices) & nchar(unique_vertices) > 0]\n\n# Create an empty graph\ncg_graph <- graph(edges = numeric(0), directed = FALSE)\n\n# Add vertices to the graph\ncg_graph <- add_vertices(cg_graph, nv = length(valid_vertices), name = valid_vertices)\n\n# Count the occurrences of each unique tie\nties_count <- table(apply(cg_frame, 1, function(x) paste(sort(x), collapse = \"-\")))\n\n# Add subsequent ties of the same kind to the count of the first instance\nunique_ties <- unique(apply(cg_frame, 1, function(x) paste(sort(x), collapse = \"-\")))\nfor (tie in unique_ties) {\n  if (ties_count[tie] > 1) {\n    first_instance <- which(apply(cg_frame, 1, function(x) paste(sort(x), collapse = \"-\")) == tie)[1]\n    ties_count[tie] <- ties_count[tie] + (ties_count[tie] - 1)\n    ties_count[tie] <- ties_count[tie] - 1  # Subtract 1 because we're counting the first instance as unique\n  }\n}\n# Add vertices to the graph\ncg_graph <- add_vertices(cg_graph, nv = length(valid_vertices), name = valid_vertices)\n\n# Count the occurrences of each unique tie\nties_count <- table(apply(cg_frame, 1, function(x) paste(sort(x), collapse = \"-\")))\n\nunique_ties <- names(ties_count)\ntie_parts <- strsplit(unique_ties, \"-\")\nfrom_vertices <- sapply(tie_parts, `[`, 1)\nto_vertices <- sapply(tie_parts, `[`, 2)\nweights <- as.vector(ties_count)\n\n# Create a data frame\ncg_tie_df <- data.frame(from = from_vertices, to = to_vertices, weight = weights)\n\n# Print the data frame\nhead(cg_tie_df)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"from\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"to\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"weight\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"AI\",\"2\":\"AI\",\"3\":\"4\",\"_rn_\":\"1\"},{\"1\":\"AI\",\"2\":\"Banking\",\"3\":\"6\",\"_rn_\":\"2\"},{\"1\":\"AI\",\"2\":\"Capitalism\",\"3\":\"12\",\"_rn_\":\"3\"},{\"1\":\"AI\",\"2\":\"Child Poverty\",\"3\":\"6\",\"_rn_\":\"4\"},{\"1\":\"AI\",\"2\":\"Civil Rights\",\"3\":\"9\",\"_rn_\":\"5\"},{\"1\":\"AI\",\"2\":\"Climate Change\",\"3\":\"12\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n### creating tnet and statnet object\n\n::: {.cell}\n\n```{.r .cell-code}\ncg_tie_df$from <- as.integer(as.factor(cg_tie_df$from))\ncg_tie_df$to <- as.integer(as.factor(cg_tie_df$to))\n\n# Create the network object\ncg_tnet <- as.tnet(cg_tie_df, type = \"weighted one-mode tnet\")\n```\n:::\n\n\n## Node-Level Measures\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Out Degree/ out-strength \ncon.outdegree <- degree_w(cg_tnet, measure = c(\"degree\", \"output\"), type=\"out\", alpha = 1)\n#In Degree/ In-strength \ncon.indegree <- degree_w(cg_tnet, measure = c(\"degree\", \"output\"), type=\"in\", alpha = 1)\n#closeness\nc_close <- closeness_w(cg_tnet, directed =NULL, gconly = FALSE, alpha = 1)\n#betweeness\nc_btwn <- betweenness_w(cg_tnet, directed =NULL, alpha = 1)\n#constraints\n\n#Rename the columns because the function output names the columns the same regardless of the IN;Out status\ncolnames(con.outdegree)[2] <- \"Out-Strength\"\ncolnames(con.outdegree)[3] <- \"Out-Degree\"\ncolnames(con.indegree)[2] <- \"In-Strength\"\ncolnames(con.indegree)[3] <- \"In-Degree\"\n\n\n#Join the node measures to the same data frame\ncon.nodes <-left_join(as.data.frame(con.outdegree), as.data.frame(con.indegree), by= \"node\")\ncon.nodes <-left_join(as.data.frame(con.nodes), as.data.frame(c_close), by= \"node\")\ncon.nodes <-left_join(con.nodes, as.data.frame(c_btwn), by= \"node\")\n\n\n#temporary rename of node column to \"name\" to join the evigenor centrality for each nodes to the dataset and then \"node\" was replaced as the variable name for the nodes\ncolnames(con.nodes)[1] <- \"name\"\ncg.stat <- as.network.matrix(cg_tnet) \nset.vertex.attribute(cg.stat, \"name\",namesss) \ncon.nodes <- left_join(con.nodes, get.eigen(cg.stat), by = \"name\")\ncolnames(con.nodes)[1] <- \"node\"\n\n\nhead(con.nodes, 15)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"node\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Out-Strength\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Out-Degree\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"In-Strength\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"In-Degree\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"closeness\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n.closeness\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"betweenness\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"eigen\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"eigen.rc\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"eigen.dc\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"34\",\"3\":\"277\",\"4\":\"0\",\"5\":\"0\",\"6\":\"28.35788\",\"7\":\"0.8340552\",\"8\":\"0.0\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"1\"},{\"1\":\"2\",\"2\":\"33\",\"3\":\"365\",\"4\":\"1\",\"5\":\"6\",\"6\":\"35.96357\",\"7\":\"1.0577521\",\"8\":\"0.0\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"2\"},{\"1\":\"3\",\"2\":\"32\",\"3\":\"462\",\"4\":\"2\",\"5\":\"28\",\"6\":\"45.11392\",\"7\":\"1.3268801\",\"8\":\"5.0\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"3\"},{\"1\":\"4\",\"2\":\"31\",\"3\":\"339\",\"4\":\"3\",\"5\":\"28\",\"6\":\"33.69244\",\"7\":\"0.9909542\",\"8\":\"0.0\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"4\"},{\"1\":\"5\",\"2\":\"30\",\"3\":\"331\",\"4\":\"4\",\"5\":\"52\",\"6\":\"32.79148\",\"7\":\"0.9644554\",\"8\":\"0.0\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"5\"},{\"1\":\"6\",\"2\":\"29\",\"3\":\"276\",\"4\":\"5\",\"5\":\"51\",\"6\":\"27.54074\",\"7\":\"0.8100219\",\"8\":\"0.0\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"6\"},{\"1\":\"7\",\"2\":\"28\",\"3\":\"245\",\"4\":\"6\",\"5\":\"60\",\"6\":\"24.57148\",\"7\":\"0.7226907\",\"8\":\"0.0\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"7\"},{\"1\":\"8\",\"2\":\"27\",\"3\":\"314\",\"4\":\"7\",\"5\":\"99\",\"6\":\"30.99681\",\"7\":\"0.9116709\",\"8\":\"4.5\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"8\"},{\"1\":\"9\",\"2\":\"26\",\"3\":\"319\",\"4\":\"8\",\"5\":\"94\",\"6\":\"31.62296\",\"7\":\"0.9300871\",\"8\":\"2.0\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"9\"},{\"1\":\"10\",\"2\":\"25\",\"3\":\"230\",\"4\":\"9\",\"5\":\"87\",\"6\":\"23.55165\",\"7\":\"0.6926956\",\"8\":\"0.0\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"10\"},{\"1\":\"11\",\"2\":\"24\",\"3\":\"322\",\"4\":\"10\",\"5\":\"148\",\"6\":\"31.62439\",\"7\":\"0.9301290\",\"8\":\"11.5\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"11\"},{\"1\":\"12\",\"2\":\"23\",\"3\":\"200\",\"4\":\"11\",\"5\":\"108\",\"6\":\"20.01304\",\"7\":\"0.5886190\",\"8\":\"0.0\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"12\"},{\"1\":\"13\",\"2\":\"22\",\"3\":\"218\",\"4\":\"12\",\"5\":\"117\",\"6\":\"21.67877\",\"7\":\"0.6376110\",\"8\":\"0.0\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"13\"},{\"1\":\"14\",\"2\":\"20\",\"3\":\"205\",\"4\":\"13\",\"5\":\"167\",\"6\":\"20.95682\",\"7\":\"0.6163771\",\"8\":\"5.5\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"14\"},{\"1\":\"15\",\"2\":\"20\",\"3\":\"193\",\"4\":\"14\",\"5\":\"143\",\"6\":\"19.20735\",\"7\":\"0.5649219\",\"8\":\"0.0\",\"9\":\"NaN\",\"10\":\"NaN\",\"11\":\"NaN\",\"_rn_\":\"15\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Strucutual Equivalnce\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#STRUCTUAL Equivalence \ncg.se <-equiv.clust(cg.stat,\n                          equiv.fun = \"sedist\",\n                          method = \"hamming\", \n                          mode = \"graph\")\nplot(cg.se,labels = cg.se$glabels)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Average Cluster Method\ncg.ase <- equiv.clust(cg.stat,\n                          equiv.fun = \"sedist\",\n                      cluster.method = \"average\",\n                          method = \"hamming\", \n                          mode = \"graph\")\nplot(cg.ase, cg.ase$glabels)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#Single Cluster Method\ncg.sse<- equiv.clust(cg.stat,\n                          equiv.fun = \"sedist\",\n                      cluster.method = \"single\",\n                          method = \"hamming\", \n                          mode = \"graph\")\nplot(cg.sse,labels = cg.sse$glabels)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Ward.D method\ncg.wse<- equiv.clust(cg.stat,\n                          equiv.fun = \"sedist\",\n                      cluster.method = \"ward.D\",\n                          method = \"hamming\", \n                          mode = \"graph\")\nplot(cg.wse,labels = cg.wse$glabels)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-10-4.png){width=672}\n:::\n:::\n\n\n## Partitioning\n\n### Height equal to 15\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Partitioning regular clustering - 15\nplot(cg.se,labels = cg.se$glabels)\nrect.hclust(cg.se$cluster, h = 15)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Partitioning Average Cluster Method - 15\nplot(cg.ase,labels = cg.ase$glabels)\nrect.hclust(cg.ase$cluster, h = 15)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#Partitioning Single Cluster Method - 15\nplot(cg.sse,labels = cg.sse$glabels)\nrect.hclust(cg.sse$cluster, h = 15)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-11-3.png){width=672}\n:::\n\n```{.r .cell-code}\n#Partitioning Ward.D method -15\nplot(cg.wse,labels = cg.wse$glabels)\nrect.hclust(cg.se$cluster, h = 15)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-11-4.png){width=672}\n:::\n:::\n\n\n### Height equal to 10\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Partitioning regular clustering -10\nplot(cg.se,labels = cg.se$glabels)\nrect.hclust(cg.se$cluster, h = 10)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Partitioning Average Cluster Method -10\nplot(cg.ase,labels = cg.ase$glabels)\nrect.hclust(cg.ase$cluster, h = 10)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#Partitioning Single Cluster Method -10\nplot(cg.sse,labels = cg.sse$glabels)\nrect.hclust(cg.sse$cluster, h = 10)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-12-3.png){width=672}\n:::\n\n```{.r .cell-code}\n#Partitioning Ward.D method -10\nplot(cg.wse,labels = cg.wse$glabels)\nrect.hclust(cg.se$cluster, h = 10)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-12-4.png){width=672}\n:::\n:::\n\n\n## BlockModeling\n\n### Height at 15 k=3\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#testing block model\nblock_se <-blockmodel(cg.stat, cg.se, k=3, h=15)\nblock_ase <-blockmodel(cg.stat, cg.ase, k=3, h=15)\nblock_sse <-blockmodel(cg.stat, cg.sse, k=3, h=15)\nblock_wse <-blockmodel(cg.stat, cg.wse, k=5, h=15) #tryin out 5\n\n#View models\nplot.block(block_se, cex.lab=.5)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot.block(block_ase, cex.lab=.5)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot.block(block_sse, cex.lab=.5)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-13-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot.block(block_wse, cex.lab=.5)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-13-4.png){width=672}\n:::\n:::\n\n\n### Height at 10, k=3\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#testing block model\nblock_se <-blockmodel(cg.stat, cg.se, k=3, h=10)\nblock_ase <-blockmodel(cg.stat, cg.ase, k=3, h=10)\nblock_sse <-blockmodel(cg.stat, cg.sse, k=3, h=10)\nblock_wse <-blockmodel(cg.stat, cg.wse, k=5, h=10) #tryin out 5\n\n#View models\nplot.block(block_se, cex.lab=.5)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot.block(block_ase, cex.lab=.5)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot.block(block_sse, cex.lab=.5)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-14-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot.block(block_wse, cex.lab=.5)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-14-4.png){width=672}\n:::\n:::\n\n\n## Let's Plot this\n\n### Statnet\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# chosen blockmodel and chose partition partitions\ncg_mod <- blockmodel(cg.stat, cg.se, k=5)\n# assign block membership to vertex attribute\ncg.stat%v%\"role\" <- cg_mod$block.membership[match(cg.stat%v%\"vertex.names\",\n                                                     cg_mod$plabels)]\n\nGGally::ggnet2(cg.stat,\n               node.color = \"role\",\n               node.size = degree(cg.stat, gmode = \"graph\"),\n               node.label = \"vertex.names\",\n               node.alpha = .7)\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n### igraph\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncg.ig <- graph_from_data_frame(cg_tnet)\nV(cg.ig)$role <- cg_mod$block.membership[match(V(cg.ig)$name, cg_mod$plabels)]\nplot.igraph(cg.ig,\n            vertex.color = V(cg.ig)$role,\n            vertex.size = 0.5+(igraph::degree(cg.ig)*0.5))\n```\n\n::: {.cell-output-display}\n![](WickedConcepts_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "WickedConcepts_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}